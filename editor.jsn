/*jslint
    indent: 4,
    maxerr: 50,
    white: true,
    browser: true,
    vars: true
*/
/*global
    module,
    require
*/
module.exports = function (response, request) {
    "use strict";
    var fs = require('fs');
    var path = require('path');
    var respond = require('./browser_modules/compiler/respondWithCompiledFiles.js');
    
    var compilerOptions = {
        'files' : (
            fs.readdirSync(
                path.normalize(__dirname + '/browser_modules')
            ).map(
                function (item) {
                    return './browser_modules/' + item;
                }
            ).filter(
                function (item) {
                    return fs.statSync(item).isFile();
                }
            )
        ),
        'require' : []
    };
    compilerOptions.require = compilerOptions.files;
    compilerOptions.require.push('url');
    
    respond(response, request, compilerOptions);
};